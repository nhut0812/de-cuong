<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω ƒê·ªÅ C∆∞∆°ng - Admin</title>
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>
    <div class="admin-container">
        <header class="admin-header">
            <div class="header-content">
                <h1>üîê Qu·∫£n L√Ω ƒê·ªÅ C∆∞∆°ng</h1>
                <div class="header-actions">
                    <span id="userEmail" style="margin-right: 15px; color: #fff; font-size: 0.9rem;">Loading...</span>
                    <button onclick="logout()" class="btn btn-secondary" style="margin-right: 10px;">üö™ ƒêƒÉng xu·∫•t</button>
                    <a href="index.html" class="btn btn-secondary">üëÅÔ∏è Xem Website</a>
                </div>
            </div>
        </header>

        <div class="admin-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <nav>
                    <a href="#dashboard" class="nav-item active" data-tab="dashboard">
                        üìä T·ªïng quan
                    </a>
                    <a href="#add" class="nav-item" data-tab="add">
                        ‚ûï Th√™m ƒë·ªÅ c∆∞∆°ng
                    </a>
                    <a href="#manage" class="nav-item" data-tab="manage">
                        üìù Qu·∫£n l√Ω ƒë·ªÅ c∆∞∆°ng
                    </a>
                    <a href="#export" class="nav-item" data-tab="export">
                        üíæ Xu·∫•t d·ªØ li·ªáu
                    </a>
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Dashboard Tab -->
                <section id="dashboard" class="tab-content active">
                    <h2>üìä T·ªïng quan</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üìö</div>
                            <div class="stat-info">
                                <h3 id="totalOutlines">0</h3>
                                <p>T·ªïng ƒë·ªÅ c∆∞∆°ng</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìÑ</div>
                            <div class="stat-info">
                                <h3 id="totalPDF">0</h3>
                                <p>File PDF</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìÉ</div>
                            <div class="stat-info">
                                <h3 id="totalDOCX">0</h3>
                                <p>File DOCX</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìÖ</div>
                            <div class="stat-info">
                                <h3 id="lastUpdateDate">-</h3>
                                <p>C·∫≠p nh·∫≠t cu·ªëi</p>
                            </div>
                        </div>
                    </div>

                    <div class="quick-actions">
                        <h3>Thao t√°c nhanh</h3>
                        <div class="action-buttons">
                            <button class="btn btn-primary" onclick="switchTab('add')">
                                ‚ûï Th√™m ƒë·ªÅ c∆∞∆°ng m·ªõi
                            </button>
                            <button class="btn btn-secondary" onclick="switchTab('manage')">
                                üìù Qu·∫£n l√Ω ƒë·ªÅ c∆∞∆°ng
                            </button>
                            <button class="btn btn-accent" onclick="switchTab('export')">
                                üíæ Xu·∫•t d·ªØ li·ªáu JSON
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Add Outline Tab -->
                <section id="add" class="tab-content">
                    <h2>‚ûï Th√™m ƒë·ªÅ c∆∞∆°ng m·ªõi</h2>
                    <div class="form-container">
                        <form id="addOutlineForm">
                            <div class="form-group">
                                <label for="fileUpload">Ch·ªçn file ƒë·ªÅ c∆∞∆°ng *</label>
                                <div class="file-upload-area" id="fileUploadArea">
                                    <input type="file" id="fileUpload" name="fileUpload" 
                                           accept=".pdf,.doc,.docx,.pptx,.txt" required>
                                    <div class="upload-placeholder">
                                        <span class="upload-icon">üìÅ</span>
                                        <p>K√©o th·∫£ file v√†o ƒë√¢y ho·∫∑c click ƒë·ªÉ ch·ªçn</p>
                                        <small>H·ªó tr·ª£: PDF, DOC, DOCX, PPTX, TXT</small>
                                    </div>
                                    <div class="file-preview" id="filePreview" style="display: none;">
                                        <span class="file-icon">üìÑ</span>
                                        <div class="file-details">
                                            <strong id="previewFileName">-</strong>
                                            <small id="previewFileInfo">-</small>
                                        </div>
                                        <button type="button" class="remove-file-btn" onclick="removeFile()">‚úï</button>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="subject">T√™n m√¥n h·ªçc *</label>
                                <input type="text" id="subject" name="subject" required 
                                       placeholder="VD: To√°n H·ªçc, V·∫≠t L√Ω...">
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="grade">Kh·ªëi/L·ªõp *</label>
                                    <select id="grade" name="grade" required>
                                        <option value="">-- Ch·ªçn l·ªõp --</option>
                                        <option value="1">L·ªõp 1</option>
                                        <option value="2">L·ªõp 2</option>
                                        <option value="3">L·ªõp 3</option>
                                        <option value="4">L·ªõp 4</option>
                                        <option value="5">L·ªõp 5</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="icon">Icon (Emoji)</label>
                                    <div class="icon-selector">
                                        <input type="text" id="icon" name="icon" value="üìö" maxlength="2">
                                        <div class="icon-suggestions">
                                            <button type="button" onclick="setIcon('üî¢')">üî¢</button>
                                            <button type="button" onclick="setIcon('üìñ')">üìñ</button>
                                            <button type="button" onclick="setIcon('üî¨')">üî¨</button>
                                            <button type="button" onclick="setIcon('üåç')">üåç</button>
                                            <button type="button" onclick="setIcon('üíù')">üíù</button>
                                            <button type="button" onclick="setIcon('üó∫Ô∏è')">üó∫Ô∏è</button>
                                            <button type="button" onclick="setIcon('üéµ')">üéµ</button>
                                            <button type="button" onclick="setIcon('üé®')">üé®</button>
                                            <button type="button" onclick="setIcon('‚öΩ')">‚öΩ</button>
                                            <button type="button" onclick="setIcon('üîß')">üîß</button>
                                            <button type="button" onclick="setIcon('üíª')">üíª</button>
                                            <button type="button" onclick="setIcon('üå≥')">üå≥</button>
                                            <button type="button" onclick="setIcon('üéØ')">üéØ</button>
                                            <button type="button" onclick="setIcon('üìö')">üìö</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="description">M√¥ t·∫£ *</label>
                                <textarea id="description" name="description" rows="3" required
                                          placeholder="VD: ƒê·ªÅ c∆∞∆°ng √¥n t·∫≠p To√°n h·ªçc l·ªõp 12 - H·ªçc k·ª≥ 1"></textarea>
                            </div>

                            <input type="hidden" id="fileName" name="fileName">
                            <input type="hidden" id="fileType" name="fileType">

                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">‚ûï Th√™m ƒë·ªÅ c∆∞∆°ng</button>
                                <button type="reset" class="btn btn-secondary">üîÑ L√†m m·ªõi</button>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- Manage Outlines Tab -->
                <section id="manage" class="tab-content">
                    <h2>üìù Qu·∫£n l√Ω ƒë·ªÅ c∆∞∆°ng</h2>
                    
                    <div class="search-section">
                        <input type="text" id="adminSearch" placeholder="üîç T√¨m ki·∫øm ƒë·ªÅ c∆∞∆°ng...">
                    </div>

                    <div class="table-container">
                        <table class="outlines-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Icon</th>
                                    <th>M√¥n h·ªçc</th>
                                    <th>L·ªõp</th>
                                    <th>M√¥ t·∫£</th>
                                    <th>File</th>
                                    <th>Lo·∫°i</th>
                                    <th>Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody id="outlinesTableBody">
                                <tr>
                                    <td colspan="8" class="loading-row">
                                        <div class="spinner"></div>
                                        ƒêang t·∫£i d·ªØ li·ªáu...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Export Tab -->
                <section id="export" class="tab-content">
                    <h2>üíæ Xu·∫•t d·ªØ li·ªáu</h2>
                    
                    <div class="export-section">
                        <div class="info-box">
                            <h3>üìã H∆∞·ªõng d·∫´n</h3>
                            <ol>
                                <li>Nh·∫•n n√∫t "Xu·∫•t JSON" ƒë·ªÉ t·∫£i file <code>outlines.json</code></li>
                                <li>File n√†y ch·ª©a t·∫•t c·∫£ d·ªØ li·ªáu ƒë·ªÅ c∆∞∆°ng b·∫°n ƒë√£ ch·ªânh s·ª≠a</li>
                                <li>Thay th·∫ø file <code>outlines.json</code> c≈© b·∫±ng file m·ªõi</li>
                                <li><strong>Quan tr·ªçng:</strong> Copy c√°c file ƒë·ªÅ c∆∞∆°ng v√†o th∆∞ m·ª•c <code>docs/</code></li>
                                <li>Commit v√† push l√™n GitHub ƒë·ªÉ c·∫≠p nh·∫≠t website</li>
                            </ol>
                        </div>

                        <div class="json-preview">
                            <h3>üëÅÔ∏è Xem tr∆∞·ªõc JSON</h3>
                            <pre id="jsonPreview">{ "loading": true }</pre>
                        </div>

                        <div class="export-actions">
                            <button class="btn btn-primary btn-large" onclick="exportJSON()">
                                üíæ Xu·∫•t file outlines.json
                            </button>
                            <button class="btn btn-secondary" onclick="copyJSON()">
                                üìã Copy JSON
                            </button>
                            <a href="sync.html" class="btn btn-success btn-large">
                                üì§ H∆∞·ªõng d·∫´n ƒë·ªìng b·ªô l√™n GitHub
                            </a>
                        </div>

                        <div class="warning-box">
                            <h4>‚ö†Ô∏è L∆∞u √Ω quan tr·ªçng</h4>
                            <ul>
                                <li><strong>File ƒë·ªÅ c∆∞∆°ng ch·ªâ ƒë∆∞·ª£c l∆∞u t·∫°m trong tr√¨nh duy·ªát</strong></li>
                                <li>B·∫°n ph·∫£i <strong>t·ª± copy file</strong> v√†o th∆∞ m·ª•c <code>docs/</code> tr√™n m√°y t√≠nh</li>
                                <li>T√™n file trong JSON ph·∫£i kh·ªõp v·ªõi t√™n file th·ª±c t·∫ø trong <code>docs/</code></li>
                                <li>ƒê∆∞·ªùng d·∫´n lu√¥n b·∫Øt ƒë·∫ßu b·∫±ng <code>docs/</code></li>
                                <li>Sau khi xu·∫•t JSON v√† copy file, nh·ªõ commit v√† push l√™n GitHub</li>
                            </ul>
                            <div style="margin-top: 15px; padding: 15px; background: white; border-radius: 8px;">
                                <strong>üìù L·ªánh git m·∫´u:</strong>
                                <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 6px; margin-top: 10px; font-size: 0.85rem;">cp ~/Downloads/De-cuong-moi.pdf docs/
git add .
git commit -m "Th√™m ƒë·ªÅ c∆∞∆°ng m·ªõi"
git push</pre>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚úèÔ∏è Ch·ªânh s·ª≠a ƒë·ªÅ c∆∞∆°ng</h2>
                <button class="close-btn" onclick="closeEditModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editOutlineForm">
                    <input type="hidden" id="editId">
                    
                    <div class="form-group">
                        <label for="editSubject">T√™n m√¥n h·ªçc *</label>
                        <input type="text" id="editSubject" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="editGrade">Kh·ªëi/L·ªõp *</label>
                            <select id="editGrade" required>
                                <option value="">-- Ch·ªçn l·ªõp --</option>
                                <option value="1">L·ªõp 1</option>
                                <option value="2">L·ªõp 2</option>
                                <option value="3">L·ªõp 3</option>
                                <option value="4">L·ªõp 4</option>
                                <option value="5">L·ªõp 5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="editIcon">Icon (Emoji)</label>
                            <input type="text" id="editIcon" maxlength="2">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="editDescription">M√¥ t·∫£ *</label>
                        <textarea id="editDescription" rows="3" required></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="editFileName">T√™n file *</label>
                            <input type="text" id="editFileName" required>
                        </div>

                        <div class="form-group">
                            <label for="editFileType">Lo·∫°i file *</label>
                            <select id="editFileType" required>
                                <option value="pdf">PDF</option>
                                <option value="docx">DOCX</option>
                                <option value="doc">DOC</option>
                                <option value="pptx">PPTX</option>
                                <option value="txt">TXT</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">üíæ L∆∞u thay ƒë·ªïi</button>
                        <button type="button" class="btn btn-secondary" onclick="closeEditModal()">‚ùå H·ªßy</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>
